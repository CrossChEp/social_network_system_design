# System design социальный сети для курса по system design

## Функциональные требования

- Создание поста с описанием
- Указание локации в посте
- Прикрепление одной или нескольких фотографий к посту
- Оценивание и комментирование постов другими пользователями
- Подписка на других пользователей для отслеживания новостей
- Поиск популярных локаций
- Поиск постов с определенными локациями
- Просмотр ленты других путешественников и ленты пользователя, 
основанной на подписках в обратном хронологическом порядке
- Пользователь может просматривать кол-во лайков на посте

## Нефункциональные требования

- DAU = 10 000 000
- Аудитория стран СНГ
- Данные хранятся всегда
- Активность пользователей
  - В среднем каждый пользователь создает 5 постов в месяц
  - В среднем каждый пользователь просматривает 30 постов в день
  - В среднем каждый пользователь лайкает 15 постов в день
  - В среднем каждый пользователь читает 20 комментариев в день
  - В среднем каждый пользователь комментирует 5 постов в день
  - В среднем каждый пользователь ищет 10 постов в день
- Лимиты
  - Максимальное кол-во изображений, которое может добавить пользователь к посту - 10
- Сезонность:
  - Повышенная активность летом и зимой, тк это сезоны отпусков
- SLA: 99.90
- SLO: 99.95

## Расчет нагрузки

### Посты

**RPS**
```
DAU = 10 000 000
Read = 10 000 000 * 30 / 86400 = 3 500 
Write = 10 000 000 * 5 / 30 / 24 / 60 / 60 = 20
```

**Трафик**

**Модель данных**

| post        |
|-------------|
| post_id     |
| content     |
| author_id   |
| location_id |
| created_at  |

| attachment |
|------------|
| post_id    |
| object_url |


**Нагрузка**
```
DAU = 10 000 000
Read = 240Б * 10 000 000 * 30 / 86400 / 1000 = 830КБ/с
Write = 240Б * 10 000 000 * 5 / 30 / 24 / 60 / 60 / 1000 = 5КБ/с
```

### Лайки

**RPS**
```
DAU = 10 000 000
Write = 10 000 000 * 15 / 86400 = 1700
Read(получаем только кол-во лайков на посте) = 10 000 000 * 30 / 86400 = 3500
```

**Трафик**

**Модель данных**

| like       |
|------------|
| post_id    |
| liker_id   |

**Нагрузка**
```
DAU = 10 000 000
Write = 16Б * 10 000 000 * 15 / 86400 / 1000 = 28КБ/с
Read = 16Б * 10 000 000 * 30 / 86400 / 1000 = 56КБ/с
```

### Комментарии

**RPS**
```
DAU = 10 000 000
Read = 10 000 000 * 20 / 86400 = 1700
Write = 10 000 000 * 5 / 86400 = 580
```

**Трафик**

**Модель данных**

| comment    |
|------------|
| comment_id |
| post_id    |
| author_id  |
| content    |
| created_at |

**Нагрузка**
```
DAU = 10 000 000
Read = 132Б * 10 000 000 * 20 / 86400 / 1000 = 305КБ/с
Write = 132Б * 10 000 000 * 5 / 86400 / 1000 = 76КБ/с
```